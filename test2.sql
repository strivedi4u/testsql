CREATE OR REPLACE Procedure INS_minTmpInsZoneWiseRPT3_NEW
IS
BEGIN
    Delete From MININSZONEWISEREPORT3_NEW;

    Delete From MININSZONEWISEREPORT3_NEXA;

    --Added by Rameshwar SCR -MINS-13252 date -05-Nov-2015
    Delete from MININSZONEWISEREPORT3_M_NEXA;

    Delete From MININSZONEWISEREPORT3_NEXA_2w;

		 Delete From MININSZONEWISEREPORT3_CV;

     Delete From MININSZONEWISEREPORT3_SUPCRY;


    If EXTRACT(DAY FROM SYSDATE) = 1  THEN
        Insert into MININSZONEWISEREPORT3_NEW
        (
        OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty,
        PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty,PREVDAYFRESHQTY, PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND P1.ISSUE_DATE>= TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND  P1.ISSUE_DATE<  TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

         UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
       AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME


        --End Added by Nishant
       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


       --==============================================================================
       -- Added By Manish For Nexa
       --==============================================================================

        Insert into MININSZONEWISEREPORT3_NEXA (OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM
        (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND P1.IS_CANCELLED=1 AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND P1.IS_CANCELLED=1
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;



       --==============================================================================
       -- Added By Rameshwar For Nexa  MINS-13252 date -05-Nov-2015
       --==============================================================================


        Insert into MININSZONEWISEREPORT3_M_NEXA (OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY,Modelno)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8),MODEL_NO
        FROM
        (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION   ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND P1.IS_CANCELLED=1 AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

      UNION ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND P1.IS_CANCELLED=1
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION   ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION   ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,MODEL_NO
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,MODEL_NO ;

        ---End
 --==============================================================================
       -- Added By Neeraj For Nexa 2 wheeler
       --==============================================================================

        Insert into MININSZONEWISEREPORT3_NEXA_2w (OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM
        (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND P1.IS_CANCELLED=1 AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND P1.IS_CANCELLED=1
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;

        -- end

				 Insert into MININSZONEWISEREPORT3_CV
        (
        OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty,
        PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty,PREVDAYFRESHQTY, PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND P1.ISSUE_DATE>= TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND  P1.ISSUE_DATE<  TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

         UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
       AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;



--For SUPER CARRY MODEL:
--Added by Skesarwani Date : 28-APR-2021

Insert into MININSZONEWISEREPORT3_SUPCRY
        (
        OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty,
        PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty,PREVDAYFRESHQTY, PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND P1.ISSUE_DATE>= TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND  P1.ISSUE_DATE<  TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
         AND P1.ISSUE_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-2)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

         UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
       AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-13)))
        AND P1.CANCELLED_DATE<TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12))) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


    Else
        Insert into MININSZONEWISEREPORT3_NEW
        ( OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty, PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty ,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))  AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
         INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
      GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
       AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA <> 1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        --End Added by Nishant
       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


       --=====================================================================================
       --Added BY Manish for Nexa
       --=====================================================================================

        Insert into MININSZONEWISEREPORT3_NEXA(OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8)
        FROM (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME ,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT  RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


  --=====================================================================================
       --Added BY Rameshwar for Nexa MINS-13252 date -05-Nov-2015
       --=====================================================================================


        Insert into MININSZONEWISEREPORT3_M_NEXA(OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY,Modelno)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8),MODEL_NO
        FROM (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME ,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION   ALL
        SELECT  RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8,SM1.MODEL_NO
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN SUB_MODEL_MASTER  SM1 ON SM1.SUB_MODEL_NO=PV.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,SM1.MODEL_NO
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,MODEL_NO ;


 --=====================================================================================
       --Added BY Neeraj for Nexa 2 wheeler
       --=====================================================================================

        Insert into MININSZONEWISEREPORT3_NEXA_2w(OutletCode, OutletName, citycode, City,REGIONID,ZONEID,PREVFRESHQTY,PREVRENEWALQTY,CURRENTFRESHQTY,CURRENTRENEWALQTY,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY)

        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,NEXA_REGION_DESC,NEXA_ZONE_DESC,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8)
        FROM (
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME ,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT  RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.ISSUE_DATE>=TRUNC(SYSDATE-1) AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION   ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION     ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4,0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,-COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4,0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1) AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION  IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        UNION  ALL
        SELECT RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4,0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=2
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        INNER JOIN REGION_MASTER RM ON CM1.REGION_ID = RM.Region_Id
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND  P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.IS_NEXA=1
        GROUP BY RM.NEXA_REGION_DESC,RM.NEXA_ZONE_DESC,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        ) O
        GROUP BY NEXA_REGION_DESC,NEXA_ZONE_DESC,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


				        Insert into MININSZONEWISEREPORT3_CV
        ( OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty, PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty ,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))  AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
         INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
      GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
       AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and DOM1.Is_Commercial=1
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        --End Added by Nishant
       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;



--For SUPER CARRY MODEL:
--Added by Skesarwani Date : 28-APR-2021

Insert into MININSZONEWISEREPORT3_SUPCRY
        ( OutletCode, OutletName, citycode, City, RegionID, ZoneID, PrevFreshQty, PrevRenewalQty, CurrentFreshQty, CurrentRenewalQty ,PREVDAYFRESHQTY,PREVDAYRENEWALQTY,PREVYEARFRESHQTY,PREVYEARRENEWALQTY )
        SELECT OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME,REGION_ID,ZONE_ID,
        SUM(QTY1),SUM(QTY2),SUM(QTY3),SUM(QTY4),SUM(QTY5),SUM(QTY6),SUM(QTY7),SUM(QTY8) FROM (
        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.ISSUE_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND P1.ISSUE_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.ISSUE_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
        AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
        AND P1.ISSUE_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))  AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(SYSDATE-1)
         AND P1.ISSUE_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        --AND P1.IS_CANCELLED=0
         AND  P1.ISSUE_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
         AND P1.ISSUE_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        --Added by Nishant
        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        -COUNT(P1.CURRENT_POLICY_NO) QTY1, 0 QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
         INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1,-COUNT(P1.CURRENT_POLICY_NO) QTY2, 0 QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))
        AND P1.CANCELLED_DATE< TRUNC(ADD_MONTHS(SYSDATE,-1)) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,-COUNT(P1.CURRENT_POLICY_NO) QTY3,0 QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, -COUNT(P1.CURRENT_POLICY_NO) QTY4, 0 QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(SYSDATE))
        AND P1.CANCELLED_DATE< TRUNC(SYSDATE) and sm.model_no='Y9T11'
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, -COUNT(P1.CURRENT_POLICY_NO) QTY5,0 QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
       AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
      GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION     ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,-COUNT(P1.CURRENT_POLICY_NO) QTY6,0 QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(SYSDATE-1)
        AND P1.CANCELLED_DATE<TRUNC(SYSDATE) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(SYSDATE))      AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION   ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3,0 QTY4, 0 QTY5,0 QTY6,-COUNT(P1.CURRENT_POLICY_NO) QTY7,0 QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
       AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
       AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))        AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME

        UNION ALL

        SELECT CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME,
        0 QTY1, 0 QTY2,0 QTY3, 0 QTY4, 0 QTY5,0 QTY6,0 QTY7,-COUNT(P1.CURRENT_POLICY_NO) QTY8
        FROM POLICY P1
        INNER JOIN MIN.POLICY_EXTENDED PE ON PE.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN DEALER_OUTLET_MASTER DOM1 ON P1.OUTLET_CODE =DOM1.OUTLET_CODE and dom1.principal_code=1 -- Change by Neeraj for 2wheeler
        INNER JOIN MIN.POLICY_VEHICLE PV ON PV.CURRENT_POLICY_NO=P1.CURRENT_POLICY_NO
        INNER JOIN SUB_MODEL_MASTER SM ON PV.SUB_MODEL_NO=SM.SUB_MODEL_NO
        INNER JOIN CITY_MASTER CM1 ON DOM1.CITY_ID= CM1.CITY_ID
        WHERE P1.POLICY_SELECTION NOT IN('F1','F2')
        AND PE.INS_APPROVAL=1 and PE.Cca_Verified=1 and PE.Send_For_Approval=1
        AND P1.IS_CANCELLED=1
        AND P1.CANCELLED_DATE>=TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-12)))
        AND P1.CANCELLED_DATE<TRUNC(ADD_MONTHS(SYSDATE,-12)) and sm.model_no='Y9T11'
        --BETWEEN TRUNC(FIRST_DAY(ADD_MONTHS(SYSDATE,-1)))    AND TRUNC(SYSDATE-2)
        GROUP BY CM1.REGION_ID,CM1.ZONE_ID,DOM1.OUTLET_CODE,DOM1.OUTLET_NAME,CM1.CITY_ID,CM1.NAME
        --End Added by Nishant
       ) O
       GROUP BY REGION_ID,ZONE_ID,OUTLET_CODE,OUTLET_NAME,CITY_ID,NAME;


    END IF;
    COMMIT;
End  ;
